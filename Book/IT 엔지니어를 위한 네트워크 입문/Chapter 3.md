
# 📚 네트워크 통신하기

## 📌 유니캐스트, 멀티캐스트, 브로드캐스트, 애니캐스트

### 유니캐스트

- 1 : 1 통신
- 출발지와 목적지가 1:1로 통신
- ex) HTTP

### 브로드캐스트

- 1 : 모든 통신
- 동일 네트워크에 존재하는 모든 호스트가 목적지
- 유니캐스트로 통신하기 전, 주로 상대방의 정확한 위치를 알기 위해 사용
- ex) ARP, 방송

### 멀티캐스트

- 1 : 그룹(멀티캐스트 구독 호스트) 통신
- 하나의 출발지에서 다수의 특정 목적지로 데이터 전송
- ex) 사내 방송, IPTV, 증권 시세 전송

### 애니캐스트

- 1:1 통신(목적지는 동일 그룹 내의 1개 호스트)
- 다수의 동일 그룹 중 가장 가까운 호스트에서 응답
- IPv4에서는 일부 기능 구현, IPv6은 모두 구현 가능
- ex) 가장 가까운 DNS 서버 찾을 때

### BUM 트래픽

- B(Broadcast), U(Unknown Unicast), M(Multicast)

## 📌 MAC 주소

### MAC 주소 (Media Access Control Adress)

- 2계층(데이터 링크 계층)에서 통신을 위해 네트워크 인터페이스에 할당된 고유 식별자
- 이더넷과 와이파이를 포함한 대부분의 IEEE 802 네트워크 기술에서 2계층 주소로 사용
- 48비트 => 16진수 12자리

### MAC 주소 동작

- NIC는 전기신호를 데이터신호로 변환 => 2계층에서 도착지 MAC주소 확인 =>  도착지 MAC주소와 NIC의 MAC가 같으면 상위 계층으로 처리 (다르면 폐기)
- 본인의 주소, 브로드캐스트 주소는 NIC 자체적으로 패킷을 처리하는 것이 아니라 OS나 애플리케이션에서 처리해야 하므로 시스템에 부하가 작용

## 📌 IP 주소

### IP주소를 포함한 3계층 주소 특징

- 사용자가 변경 가능한 논리 주소
- 주소에 레벨이 있음. 그룹을 의미하는 네트워크 주소와 호스트 주소로 나뉜다.

### 클래스

- A 클래스 : 네트워크 주소 부분이 1개의 옥텟. 앞 옥텟의 주소가 0~127 => 0 0000000 ~ 0 1111111
- B 클래스 : 네트워크 주소 부분이 2개 옥텟. 앞 옥텟의 주소가 128~191 => 10 000000 ~ 10 111111
- C 클래스 : 네트워크 주소 부분이 3개 옥텟. 앞 옥텟의 주소가 192~223 => 110 00000 ~ 110 11111

### 클래스풀과 클래스리스

- 클래스풀 : 클래스 기반의 IP 주소 체계 => 맨 앞자리 숫자로 어느 클래스인지 구분 => 서브넷 마스크가 필요없음
- 클래스리스 : IP 낭비문제를 해결하기 위해 등장한 주소 체계

### IP 주소 부족과 낭비 문제 해결 방법

- 단기 대책 : 클래스리스,CIDR
- 중기 대책 : NAT, 사설 IP 주소
- 장기 대책 : IPv6

### 서브넷 마스크

- 네트워크와 호스트 주소를 나누는 구분자. IP주소와 and 연산을 하여 네트워크 주소만 뽑아낸다.

### 서브네팅

- 원래 부여된 클래스의 기준을 무시하고 새로운 네트워크-호스트 구분 기준을 사용자가 정해 원래 클래스풀 단위의 네트워크보다 더 쪼개 사용하는 것

### 공인 IP와 사설 IP

- 공인 IP : 인터넷에 접속하려는 IP주소. 전세계에서 유일한 식별자
- 사설 IP : 인터넷에 연결하지 않고 개인적으로 네트워크를 구성할 때 사용하는 IP 주소. 보통 NAT기술을 사용해 사설 IP 주소를 사용한다.

## 📌 TCP와 UDP

### 4계층의 목적

- 목적지를 찾아가는 주소가 아니라 애플리케이션에서 사용하는 프로세스를 정확히 찾아가고 데이터를 분할한 패킷을 잘 쪼개 보내고 받은 패킷을 잘 조립하는 것

### TCP

- 세션을 안전하게 연결하고 데이터를 분할하고 분할된 패킷이 잘 전송되었는지 확인하는 기능
- 시퀀스 번호 : 패킷에 순서를 부여
- 응답 번호(ACK 번호)  ex) ACK 숫자 => 패킷은 잘 받았으니 이제 숫자를 보내달라.

### 윈도 사이즈

- TCP에서는 패킷을 한꺼번에 많이 보낸다.
- 네트워크 상태가 안좋으면 패킷 유실가능성이 커지므로 한 번에 데이터를 받을 수 있는 데이터 크기 설정해야 하는데, 이를 윈도 사이즈라 한다.
- 슬라이딩 윈도: 윈도 사이즈를 조절하는 것

### 3방향 핸드셰이크 (TCP)

- 통신 전, 각 통신에 필요한 리소스를 미리 확보하는 작업
- TCP에서는 3번의 패킷을 주고받으면서 통신을 서로 준비

### UDP

- 데이터 전송을 보장하지 않는 프로토콜 (비연결형)
- 시간에 민감한 프로토콜 애플리케이션을 사용하는 경우 ex) 실시간 스트리밍, 음성 데이터, 사내 방송, 증권 시세 데이터 전송
- 중간에 데이터가 몇 개 유실되는 것보다 재전송하기 위해 잠시 동영상이나 음성이 멈추는 것을 더 이상하게 느낄때 사용
- 사전 연결 확립하는 절차(TCP의 3방향 핸드셰이크)가 없음

| TCP | UDP |
| --- | --- |
| 연결 지향 | 비연결형 |
| 오류 제어 수행 | 오류 제어 수행x |
| 흐름 제어 수행 | 흐름 제어 수행x |
| 유니캐스트 | 유니캐스트, 멀티캐스트, 브로드캐스트 |
| 전이중(Full Dulplex) | 반이중(Half Duplex) |
| 데이터 전송 | 실시간 트래픽 전송 |

## 📌 ARP

### ARP

- IP 주소로 MAC 주소를 알아내기 위한 프로토콜
- ARP 요청을 브로드캐스트해 IP주소를 알아낸다.

### GARP

- 자신의 IP와 MAC 주소를 알릴 목적으로 사용
- 목적
    - IP 주소 충돌 감지
    - 상대방(동일 서브넷 상의 다른)의 ARP 테이블 갱신
    - HA(고가용성) 용도의 클러스터링 ==> 스탠바이 상태가 액티브 상태가 되면 GARP 패킷을 네트워크에 보내 액티브 장비가 변경되었음을 알림 
    - VRRP, HSRP  => 스위치 장비의 MAC 테이블 갱신이 목적

### RARP

- IP 주소가 정해져 있지 않은 단말이 IP 할당을 요청할 때 사용
- 나 자신의 MAC 주소는 알지만 IP가 아직 할당되지 않아 IP를 할당해주는 서버에 어떤 IP주소를 써야 하는지 물어볼 때 사용

## 📌 서브넷과 게이트웨이

### 게이트웨이

- 원격지 네트워크와의 통신에 사용하는 장비. 3계층 장비(라우터와 L3 스위치)가 이 역할을 할 수 있다.

### 프록시 ARP

- ARP를 대행해주는 기능
- 원격지 통신은 기본 게이트웨이에 ARP 요청을 보내고 패킷을 기본 게이트웨이 쪽으로 보내야만 통신이 가능.  
하지만 기본 게이트웨이에 프록시 ARP가 활성화된 경우, 원격지 통신이더라도 로컬에 ARP 브로드캐스트를 통해 통신할 수 있음.  
프록시 ARP가 활성화된 기본 게이트웨이(라우터)는 ARP 브로드캐스트가 들어오면 자신이 대행해 ARP 응답을 해준다.

### 2계층 통신

- 로컬 네트워크 통신
- 3계층 네트워크 장비(라우터) 도움 없이 통신이 가능
- ARP 요청을 보낼 때 직접 브로드캐스트를 이용

### 3계층 통신

- 원격지 네트워크 통신
- ARP 요청을 기본 게이트웨이의 IP 주소로 요청
- 패킷의 목적지 MAC 주소에 디폴트 게이트웨이의 MAC 주소가 사용


