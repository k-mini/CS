
# 📚 스위치: 2계층 장비

## 📌 스위치 장비 동작

### 스위치 특징

- 스위치 없던 오래된 이더넷 네트워크에서는 패킷을 전송할 때 서로 경합해 그로 인한 네트워크 성능 저하가 컸다.
- 이런 경쟁을 없애고 패킷을 동시에 여러 장비가 서로 간섭 없이 통신하도록 도와주는 장비 => 스위치
- MAC 주소 테이블을 갖고 있음

### 스위치 동작 방식

- 플러딩 (Flooding)
- 어드레스 러닝 (Address Learning)
- 포워딩 \/ 필터링 (Forwarding\/Filtering)

### 플러딩 

- 패킷이 들어온 포트를 제외하고 모든 포트로 패킷을 흘리는 동작 방식
- 받은 패킷의 목적지 MAC주소가 MAC 주소 테이블에 없으면 플러딩
- 플러딩 후 받은 패킷 정보의 MAC주소를 보고 학습(어드레스 러닝) => 목적지 MAC 주소에 전송(포워딩 필터링)

### 어드레스 러닝

- 스위치가 MAC 주소 테이블을 만들고 유지하는 과정
- 스위치의 특정 포트에 들어온 패킷 => 해당 패킷의 출발지 MAC 주소와 포트번호를 MAC 주소 테이블에 기록
- 브로드캐스트나 멀티캐스트에 대한 MAC 주소를 학습할 수 없다.

### 포워딩\/필터링

- 도착지 MAC 주소를 확인하고 자신이 가진 MAC 테이블과 비교해 맞는 정보가 있으면 매치되는 포트로 패킷을 보냄 => 포워딩
- 다른 포트로는 해당 패킷을 보내지 않음 => 필터링
- 유니캐스트에 대해서만 포워딩과 필터링 작업 수행
- BUM 트래픽(브로드캐스트,언노운 유니캐스트, 멀티캐스트)는 학습이 되지 않았으므로 포워딩,필터링이 되지 않음 => 플러딩


## 📌 VLAN

### VLAN

- 물리적 배치와 상관없이 LAN을 논리적으로 분할, 구성하는 기술
- 해당 기술을 쓰면 하나의 물리 스위치에서 여러 개의 네트워크를 나누어 사용할 수 있음

### VLAN의 종류

- 포트 기반의 VLAN => 어떤 단말이 접속하든지 스위치에 특정 포트에 VLAN을할당하면 할당된 VLAN이 속하게 된다.
- MAC 주소 기반의 VLAN(다이나믹 VLAN) => 단말의 MAC 주소를 기반으로 VLAN을 할당하는 기술  
=> 단말이 연결되면 단말의 MAC 주소를 인식한 스위치가 해당 포트로 지정된 VLAN을 변경

### VLAN 특징

- 포트 기반 VLAN에서는 한 대의 스위치에 연결되더라도 서로 다른 VLAN이 설정된 포트 간에는 통신 불가 => 3계층 장비 필요

### 태그 포트(트렁크 포트)

- 물리적으로 다른 스위치에 같은 VLAN끼리 통신하려면 VLAN별로 포트가 필요함.
- 태그 포르틀 사용하면 1개의 포트만으로 여러 개의 VLAN을 전송 가능 

## 📌 STP

### SPoF(Single Point of Failure: 단일 장애점)

- 하나의 시스템이나 구성 요소에서 고장이 발생했을 때 전체 시스템의 작동이 멈추는 요소

### 네트워크 루프

- 네트워크에 연결된 모양이 고리형태
- 패킷이 네트워크를 따라 계속 전송되어 네트워크를 마비시키는 현상 ex) 브로드캐스트 스톰

### STP(Spanning Tree Protocol)

- 루프를 확인하고 적절히 포트를 사용하지 못하게 만들어 루프를 예방하는 메커니즘
- 스위치는 연결 상황을 파악하기 위해 BPDU(Bridge Protocol Data Unit)라는 프로토콜을 통해 스위치 간에 정보를 전달  
하고 수집된 정보를 통해 전체 네트워크 트리를 만들어 루프 구간을 확인

### RSTP(Rapid Spanning Tree Protocol)

- 향상된 스패닝 트리 프로토콜은 2~3초로 절체시간이 짧아서 TCP 기반 애플리케이션이 세션을 유지할 수 있다.
- 토폴로지 변경이 일어난 스위치 자신이 모든 네트워크에 토폴로지 변경을 직접 전파

### MST(Multiple Spanning Tree)

- CST + PVST => MST
- 여러개의 VLAN을 그룹으로 묶고 그룹마다 별도의 스패닝 트리가 동작
