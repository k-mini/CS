
# 📚 입출력 시스템과 저장장치

## 📌 입출력 시스템

### 컴퓨터의 구성

- 필수 장치 => CPU, 메모리
- 주변 장치 => 입출력장치, 저장장치

### 저속 주변장치와 고속 주변장치

- 저속 주변장치 : 메모리와 주변장치 사이에 오고 가는 데이터의 양이 적어 데이터 전송률이 낮은 장치 ex) 키보드
- 고속 주변장치 : 메모리와 주변장치 사이에 대용량의 데이터가 오고 가는 데이터 전송률이 높은 장치 ex) 그래픽카드, 하드디스크

### 버스와 채널

- 여러 주변장치는 메인보드 내의 버스로 연결된다.
- 버스에는 많은 종류의 장치가 연결되기 때문에 버스를 1개만 사용하면 병목 현상이 발생한다. 따라서 여러 개의 버스를 묶어서 사용한다.
- 이 때 데이터가 지나다니는 하나의 통로를 채널이라 한다. ex) 4채널 버스, 1채널 버스 ..

### 입출력 버스의 초기 구조

- 초기에는 주변장치가 많지 않았고 CPU와 메모리의 속도도 빠르지 않았다.
- 모든 장치가 하나의 버스로 연결되고 CPU가 작업을 진행하다가 입출력 명령을 만나면 직접 입출력장치에서 데이터를 가져왔었음(폴링 방식)

### 입출력 제어기를 사용한 입출력 버스 구조

- 주변 장치가 다양해지고 CPU와 메모리의 성능이 향상됨에 따라 입출력제어기가 등장
- 메인버스 : CPU와 메모리가 사용
- 입출력 버스 : 주변장치가 사용
- CPU에서 입출력 요청이 오면 입출력 제어기는 입출력장치로부터 데이터를 직접 송수신한다. => CPU와 메모리 작업이 느려지는 것을 방지 => 전체 작업 효율 향상

### 입출력 버스의 분리

- 고속 주변장치와 저속 주변장치가 입출력 버스를 공유하면 입출력 속도가 현저히 저하 => 고속 입출력버스와 저속 입출력 버스로 분리
- 고속 입출력 버스와 저속 입출력 버스 사이의 데이터 전송은 채널 선택기가 관리한다.
- 입출력 제어기는 여러 채널에 연결된 주변 장치로부터 전송된 데이터를 적절히 배분하여 하나의 데이터 흐름을 만든다.
- 채널선택기는 여러 채널에서 전송된 데이터 중 어떤 것을 메모리로 보낼지 결정한다.

### 그래픽카드의 분리

- 해상도가 높아지고 3D 게임이 보급되면서 그래픽카드가 계산해야 하는 양이 증가 => GPU 부착 => 전송해야 되는 데이터가 대용량 => 입출력버스에서 분리하고 메인버스에 바로 연결
- 그래픽 버스 : 메인버스에 바로 연결된 버스
- AGP : 그래픽 전용 포트

### 현대의 컴퓨터 버스

- 메인버스 : CPU와 메모리
- 그래픽버스 : 그래픽카드
- 고속 입출력 버스 
- 저속 입출력 버스
- 하나의 버스 채널은 주소버스, 데이터 버스, 제어 버스로 구성된다.

### 직접 메모리 접근(DMA)

- 원래 메모리는 CPU의 명령에 따라 작동
- 직접 메모리 접근은 CPU의 도움 없이도 메모리에 접근할 수 있도록 입출력 제어기에 부여된 권한
- 입출력 제어기에는 직접 메모리에 접근하기 위한 DMA 제어기가 마련되어 있다.
- 주변장치에서 전송된 데이터는 DMA 제어기를 거쳐 메모리로 올라간다.
- 반대로 메모리에서 주변장치로 데이터를 전송할 때는 DMA 제어기가 메모리에서 데이터를 가져오면 채널선택기에서 적당한 채널로 전송

### 메모리 맵 입출력

- 과거에는 DMA 제어기가 전송하는 데이터를 '입출력 메모리'라는 별도의 메모리에 보관
- 오늘날에는 메모리 내에 DMA 제어기가 데이터를 옮기는 공간을 분리하여 메인메모리를 운영 => 메모리 맵 입출력

### 인터럽트

- 주변장치의 입출력 요구나 하드웨어의 이상 현상을 CPU에 알려주는 역할 => 외부 인터럽트
- 입출력 제어기와 DMA 제어기의 협업으로 작업이 완료 => 입출력 제어기가 CPU에 인터럽트를 보냄
- IRQ : 각 장치에 부여된 고유의 인터럽트 번호. CPU는 IRQ를 보고 어떤 장치에서 인터럽트가 발생했는지 확인

| 종류 | 특징 | 비고 |
| ---- | ---- | ---- |
| 외부 인터럽트 | 입출력 및 하드웨어 관련 인터럽트 | 주변장치 변화, 하드웨어 이상 |
| 내부 인터럽트 | 프로세스의 오류로 발생하는 인터럽트 | 예외 상황 인터럽트 |
| 시그널 | 사용자의 요청으로 발생하는 인터럽트 | 자발적 인터럽트 |

### 인터럽트 벡터

- 여러 인터럽트 중 어떤 인터럽트가 발생했는지 파악하기 위해 사용하는 자료 구조

### 인터럽트 핸들러

- 인터럽트의 처리 방법을 함수 형태로 만들어놓은 것
- 인터럽트 벡터에는 해당 인터럽트 핸들러를 호출할 수 있도록 인터럽트 핸들러가 저장된 메모리 주소가 포인터 형태로 등록되어 있다.

### 버퍼의 역할

- 두 장치의 속도 차이를 완화하는 역할
- 하드디스크나 CD-ROM 등 대부분의 입출력장치는 버퍼를 이용하여 느린 속도를 보완
- 커널 버퍼 : 커널이 입출력장치로 보내야 할 데이터를 버퍼에 담아놓으면 입출력 제어기가 커널 버퍼에서 입출력장치로 데이터를 보낸다.
- 단일 버퍼 : 데이터를 담는 작업과 가져가는 작업을 동시에 하기가 어렵다.
- 이중 버퍼 : 하나는 데이터를 담는용도, 하나는 데이터를 가져가는 용도
- 운영체제는 버퍼가 다 차지 않으면 전송하지 않는다.(꽉 차 있지 않으면 일정 시간이 흐른 후 데이터를 전송)
- 플러시(flush) : 강제로 버퍼내용 전송


## 📌 디스크 장치



## 📌 디스크 스케줄링

## 📌 RAID

## 📌 [심화] 하드웨어의 규격과 발전
