
# 📚 입출력 시스템과 저장장치

## 📌 입출력 시스템

### 컴퓨터의 구성

- 필수 장치 => CPU, 메모리
- 주변 장치 => 입출력장치, 저장장치

### 저속 주변장치와 고속 주변장치

- 저속 주변장치 : 메모리와 주변장치 사이에 오고 가는 데이터의 양이 적어 데이터 전송률이 낮은 장치 ex) 키보드
- 고속 주변장치 : 메모리와 주변장치 사이에 대용량의 데이터가 오고 가는 데이터 전송률이 높은 장치 ex) 그래픽카드, 하드디스크

### 버스와 채널

- 여러 주변장치는 메인보드 내의 버스로 연결된다.
- 버스에는 많은 종류의 장치가 연결되기 때문에 버스를 1개만 사용하면 병목 현상이 발생한다. 따라서 여러 개의 버스를 묶어서 사용한다.
- 이 때 데이터가 지나다니는 하나의 통로를 채널이라 한다. ex) 4채널 버스, 1채널 버스 ..

### 입출력 버스의 초기 구조

- 초기에는 주변장치가 많지 않았고 CPU와 메모리의 속도도 빠르지 않았다.
- 모든 장치가 하나의 버스로 연결되고 CPU가 작업을 진행하다가 입출력 명령을 만나면 직접 입출력장치에서 데이터를 가져왔었음(폴링 방식)

### 입출력 제어기를 사용한 입출력 버스 구조

- 주변 장치가 다양해지고 CPU와 메모리의 성능이 향상됨에 따라 입출력제어기가 등장
- 메인버스 : CPU와 메모리가 사용
- 입출력 버스 : 주변장치가 사용
- CPU에서 입출력 요청이 오면 입출력 제어기는 입출력장치로부터 데이터를 직접 송수신한다. => CPU와 메모리 작업이 느려지는 것을 방지 => 전체 작업 효율 향상

### 입출력 버스의 분리

- 고속 주변장치와 저속 주변장치가 입출력 버스를 공유하면 입출력 속도가 현저히 저하 => 고속 입출력버스와 저속 입출력 버스로 분리
- 고속 입출력 버스와 저속 입출력 버스 사이의 데이터 전송은 채널 선택기가 관리한다.
- 입출력 제어기는 여러 채널에 연결된 주변 장치로부터 전송된 데이터를 적절히 배분하여 하나의 데이터 흐름을 만든다.
- 채널선택기는 여러 채널에서 전송된 데이터 중 어떤 것을 메모리로 보낼지 결정한다.

### 그래픽카드의 분리

- 해상도가 높아지고 3D 게임이 보급되면서 그래픽카드가 계산해야 하는 양이 증가 => GPU 부착 => 전송해야 되는 데이터가 대용량 => 입출력버스에서 분리하고 메인버스에 바로 연결
- 그래픽 버스 : 메인버스에 바로 연결된 버스
- AGP : 그래픽 전용 포트

### 현대의 컴퓨터 버스

- 메인버스 : CPU와 메모리
- 그래픽버스 : 그래픽카드
- 고속 입출력 버스 
- 저속 입출력 버스
- 하나의 버스 채널은 주소버스, 데이터 버스, 제어 버스로 구성된다.

### 직접 메모리 접근(DMA)

- 원래 메모리는 CPU의 명령에 따라 작동
- 직접 메모리 접근은 CPU의 도움 없이도 메모리에 접근할 수 있도록 입출력 제어기에 부여된 권한
- 입출력 제어기에는 직접 메모리에 접근하기 위한 DMA 제어기가 마련되어 있다.
- 주변장치에서 전송된 데이터는 DMA 제어기를 거쳐 메모리로 올라간다.
- 반대로 메모리에서 주변장치로 데이터를 전송할 때는 DMA 제어기가 메모리에서 데이터를 가져오면 채널선택기에서 적당한 채널로 전송

### 메모리 맵 입출력

- 과거에는 DMA 제어기가 전송하는 데이터를 '입출력 메모리'라는 별도의 메모리에 보관
- 오늘날에는 메모리 내에 DMA 제어기가 데이터를 옮기는 공간을 분리하여 메인메모리를 운영 => 메모리 맵 입출력

### 인터럽트

- 주변장치의 입출력 요구나 하드웨어의 이상 현상을 CPU에 알려주는 역할 => 외부 인터럽트
- 입출력 제어기와 DMA 제어기의 협업으로 작업이 완료 => 입출력 제어기가 CPU에 인터럽트를 보냄
- IRQ : 각 장치에 부여된 고유의 인터럽트 번호. CPU는 IRQ를 보고 어떤 장치에서 인터럽트가 발생했는지 확인

| 종류 | 특징 | 비고 |
| ---- | ---- | ---- |
| 외부 인터럽트 | 입출력 및 하드웨어 관련 인터럽트 | 주변장치 변화, 하드웨어 이상 |
| 내부 인터럽트 | 프로세스의 오류로 발생하는 인터럽트 | 예외 상황 인터럽트 |
| 시그널 | 사용자의 요청으로 발생하는 인터럽트 | 자발적 인터럽트 |

### 인터럽트 벡터

- 여러 인터럽트 중 어떤 인터럽트가 발생했는지 파악하기 위해 사용하는 자료 구조

### 인터럽트 핸들러

- 인터럽트의 처리 방법을 함수 형태로 만들어놓은 것
- 인터럽트 벡터에는 해당 인터럽트 핸들러를 호출할 수 있도록 인터럽트 핸들러가 저장된 메모리 주소가 포인터 형태로 등록되어 있다.

### 버퍼의 역할

- 두 장치의 속도 차이를 완화하는 역할
- 하드디스크나 CD-ROM 등 대부분의 입출력장치는 버퍼를 이용하여 느린 속도를 보완
- 커널 버퍼 : 커널이 입출력장치로 보내야 할 데이터를 버퍼에 담아놓으면 입출력 제어기가 커널 버퍼에서 입출력장치로 데이터를 보낸다.
- 단일 버퍼 : 데이터를 담는 작업과 가져가는 작업을 동시에 하기가 어렵다.
- 이중 버퍼 : 하나는 데이터를 담는용도, 하나는 데이터를 가져가는 용도
- 운영체제는 버퍼가 다 차지 않으면 전송하지 않는다.(꽉 차 있지 않으면 일정 시간이 흐른 후 데이터를 전송)
- 플러시(flush) : 강제로 버퍼내용 전송


## 📌 디스크 장치

### 하드디스크 구조

- 스핀들 : 원통 축
- 플래터 : 원판 모양의 구조. 표면에 자성체가 발려 있어 자기를 이용해 0과 1을 저장
- 섹터 : 하드디스크의 가장 작은 저장 단위
- 블록 : 하드디스크와 컴퓨터 사이에 데이터를 전송하는 가장 작은 논리적인 저장 단위. 여러 개의 섹터로 구성, 윈도우 운영체제에서는 블록 대신 클러스터라고 표현
- 메모리에서는 바이트마다 주소가 배정, 하드디스크에서는 블록마다 주소가 배정
- 트랙 : 동일한 동심원에 있는 섹터의 집합
- 실린더 : 여러 개의 플래터에 있는 같은 트랙의 집합
- 헤드 : 헤드의 수는 플래터의 표면 수 . 읽기/쓰기 헤드를 사용

### 배드 섹터

- 플래터에 표면에 상처가 생겨 데이터를 저장할 수 없는 섹터

### 각속도 일정 방식과 선속도 일정 방식

- 하드디스크의 각속도 일정 방식 : 플래터가 항상 일정한 속도로 회전 => 바깥쪽 트랙의 속도가 안쪽 트랙 속도보다 빠름
    - 특징 : 모든 트랙의 섹터수가 같음, 트랙별로 섹터의 크기가 다름
    - 장점 : 구동장치가 단순, 조용하게 작동
    - 단점 : 바깥쪽 트랙으로 갈수록 섹터가 커져 낭비되는 공간이 생성
- CD의 선속도 일정 방식 : 어느 트랙에서나 단위시간당 디스크의 이동거리가 같다. => 바깥족 트랙은 느리고 안쪽 트랙은 빠르다.
    - 특징 : 모든 섹터의 크기가 같음, 트랙별로 섹터의 개수가 다름, 트랙의 움직이는 속도가 같음
    - 장점 : 한정된 공간에 많은 데이터를 담을 수 있음
    - 단점 : 소음, 모터 제어 복잡

### 디스크의 데이터 전송 시간

- 데이터 전송 시간 = 탐색 시간 + 회전 지연 시간 + 전송 시간

### 파티션

- 디스크를 논리적으로 분할하는 작업
- 파티션 하나에 하나의 파일 시스템이 탑재

### 포매팅

- 디스크를 초기화 하는 작업
- 디스크에 파일 시스템(파일 테이블)을 탑재하고 디스크 표면을 초기화하여 사용할 수 있는 형태로 만드는 작업
- 파일 테이블(시스템) : 디스크에 저장된 파일의 위치와 크기 정보를 담고 있다. ex) 윈도우의 FAT, NTFS  유닉스의 I-node
- 느린 포매팅 : 일반적인 포매팅(파일 시스템 탑재, 디스크 표면 초기화)
- 빠른 포매팅 : 데이터를 그대로 둔 채 파일 테이블을 초기화

### 마운트

- 유닉스 운영체제에서 여러 개의 파티션을 하나로 통합하는 기능
- 여러 개의 하드디스크를 하나의 파티션으로 통합하는 기능

### 조각 모음

- 하드디스크는 데이터가 앞에서부터 차곡차곡 쌓이지만 파일을 저장했다 지우면 중간에 빈 공간이 생긴다 => 조각화,단편화
- 파일이 여러 조각으로 저장되면 => 하드디스크의 여러 곳을 읽는다 => 탐색시간(헤드의 이동시간) 증가 => 성능 저하
- 조각모음은 조각화, 단편화를 줄여주는 작업

### 네트워크 저장장치

- DAS(Direct Attached Storage) => 서버와 같은 컴퓨터에 직접 연결된 저장장치
- NAS(Network Attached Storage) => 기존의 저장장치를 LAN이나 WAN에 붙여서 사용하는 방식
- SAN(Storage Area Network) => 데이터 서버, 백업 서버, RAID 등의 장치를 네트워크로 묶고 데이터 접근을 위한 서버를 두는 형태

## 📌 디스크 스케줄링

### FCFS 디스크 스케줄링 (First Come, First Service disk scheduling)

- 요청이 들어온 트랙 순서대로 서비스
- 비효율적

### SSTF 디스크 스케줄링 (Shortest Seek Time disk scheduling)

- 현재 헤드가 있는 위치에서 가장 가까운 트랙 부터 서비스
- 아사 현상 발생 => 공평성 위배
- 예전엔 일괄 작업 시스템처럼 다른 프로세스에 영향을 주지 않고 빠른 응답 성능을 필요로 하는 시스템에서 사용

### 블록 SSTF 디스크 스케줄링 (block SSTF disk scheduling)

- 트랙 요청을 일정한 블록 형태로 묶어서 SSTF 스케줄링을 진행
- SSTF에 에이징을 적용한 것
- 공평성을 어느정도 보장하지만 비효율

### SCAN 디스크 스케줄링 (SCAN disk scheduling)

- 헤드가 맨 마지막 트랙에 도착할 때까지 뒤돌아가지 않고 계속 한방향으로만 전진하면서 요청받은 트랙을 서비스
- 엘리베이터 기법
- 동일한 트랙이나 실린더의 요청이 연속적으로 발생하면 => 제자리 머문다 => 아사 현상

### C-SCAN 디스크 스케줄링 (Circular SCAN disk scheduling)

- 헤드가 한쪽 방향으로 움직일 때는 트랙을 서비스하고 반대 방향으로 돌아올 때는 서비스하지않고 이동만 하는 방식
- 공평하다. but 작업없이 헤드가 이동하여 비효율적이다.

### LOOK 디스크 스케줄링 (LOOK disk scheduling)

- SCAN의 불필요한 부분을 제거
- 더 이상 서비스할 트랙이 없으면 헤드가 끝까지 가지 않고 중간에서 방향을 바꾼다

### C-LOOK 디스크 스케줄링 (Circular LOOK disk scheduling)

- C-SCAN에서 불필요한 부분을 제거한 것
- C-SCAN의 LOOK 디스크 스케줄링
- 더 이상 서비스할 트랙이 없으면 중간에서 방향을 바꾼다.

### SLFT 디스크 스케줄링 (Shortest Latency Time First disk scheduling)

- 헤드가 고정되있는 방식에서 사용하는 스케줄링
- 작업 요청이 들어온 섹터의 순서를 디스크가 회전하는 방향에 맞추어 다시 정렬
- 탐색 시간이 없어서 빠르다.
- 고가

## 📌 RAID

### RAID (Rebundant Array of Independent Disks)

- 자동으로 백업을 하고 장애가 발생하면 이를 복구하는 시스템
- 동일한 규격의 디스크를 여러 개 모아 구성

### 스트라이핑

- 데이터를 여러조각으로 나누어 보내는 방식 => 입출력 속도 증가

### RAID 0(스트라이핑)

- 데이터를 여러 갈래로 찢어서 저장
- 4개로 구성된 RAID 0은 1 개의 디스크로 이루어진 일반 시스템보다 이론적으로 입출력 속도가 4배 빠르다.
- 장애 발생 시 복구 기능이 없음

### RAID 1(미러링)

- 하나의 데이터를 2개의 디스크로 나누어 저장
- 장애 시 백업 디스크로 활용

### RAID 2

- 오류 교정 코드를 관리
- 오류 검출 코드 : 오류가 발생했는지 확인할 수 있는 코드 ex) 패리티 비트
- 오류 교정 코드 : 오류가 발생했는지 확인하는 동시에 교정할 수 있는 코드 ex) 허밍 코드
- 장애 발생 시 오류 교정 코드를 이용하여 데이터를 복구

### RAID 3

- 패리티 비트를 사용하여 데이터를 복구
- RAID의 경우 패리티 비트로 오류를 복구할 수 있다.
- N-way 패리티 방식
- 섹터 단위로 디스크에 데이터를 저장

### RAID 4 

- RAID 3과 같으나 디스크에 블록 단위로 저장
- 패리티 비트 디스크의 병목 현상 발생

### RAID 5

- RAID 4의 패리티 비트를 여러 디스크에 분산하여 구성
- 패리티 비트 디스크의 병목 현상 완화
- 디스크 2개가 동시에 장애가 발생하면 복구가 불가

### RAID 6

- 패리티 비트를 2개로 구성 => 디스크 2개의 장애를 복구할 수 있다.

### RAID 10과 RAID 0+1

- RAID 1의 미러링기능과 RAID 0의 빠른 데이터 전송기능을 결합한 형태
- RAID 10이 많이 사용됨

### RAID 50과 RAID 60

- RAID 5,6의 각 기능과 입출력 향상

## 📌 [심화] 하드웨어의 규격과 발전

### 메인보드의 포트

- CPU 포트 : CPU 꽂는 곳
- 램 포트 : 램 꽂는 곳
- 그래픽 포트 : 그래픽 카드 꽂는곳. CPU와 직접 연결
- SATA : 하드디스크 같은 저장장치를 연결하는 직렬 ATA 포트
- PCI : PCI 버스 인터페이스에 연결. 랜카드, 사운드카드 등이 연결되나, 요즘에는 메인보드에 그래픽카드, 사운드카드, 랜카드가 내장되어 있음

### 직렬 포트와 병렬 포트

- 직렬 방식 : 데이터가 한 줄로 이동
- 병렬 방식 : 데이터가 여러 줄로 이동

### USB 포트

- 주변 장치가 늘어나고, 다양한 장치를 동시에 컴퓨터에 작업할 일이 많아짐
- 직렬 포트와 병렬 포트 등 기존의 다양한 연결 방식을 대체하기 위해 만든 포트
- 전원 공급 가능 => 충전 용도로도 사용

### 포트 연결 단자

- USB : 다양한 주변장치 연결할 수 있는 범용 포트. 전원 공급 가능
- SATA : 컴퓨터 내부에 있는 각종 저장장치를 연결할 때 사용. 전원 공급선 따로 연결
- D-SUB : 아날로그 데이터 전송. 모니터 연결 단자
- DVI : 디지털로 데이터 전송. 모니터 표준 단자
- HDMI : 비디오 신호와 오디오 신호를 하나의 단자로 구현

